## MATLAB Subsystem

In MATLAB/Simulink, a subsystem is generally used to group blocks that together perform a specific function or task.

There are two types of subsystems: Virtual subsystems and Atomic (non-virtual) subsystems, each serving a different purpose.

### 1. Virtual Subsystems

- Virtual subsystems provide graphical hierarchy only. They are used to organize a model and improve readability.
- Virtual subsystems do not affect execution behavior.
- During compilation, the Simulink engine flattens virtual subsystems.
- Blocks inside a virtual subsystem are treated as if they were at the same level as surrounding blocks.

### 2. Atomic (Non-Virtual) Subsystems

- Atomic subsystems provide both graphical hierarchy and execution boundaries.
- Atomic subsystems are executed as a single, indivisible unit.
- Simulink does not optimize across the subsystem boundary.
- All atomic subsystems appear with a bold border in the Simulink canvas.

In other words, an atomic subsystem executes all internal blocks as one unit, and its execution cannot be interrupted by other logic paths.

## Example: Execution Order and Algebraic Loops

Let's see an example below:

![Example of Time based debouncing](https://github.com/lexma1412/lexma1412.github.io/blob/main/assets/20225-12-15-Subsystem.png?raw=true)

### Model Overview

We have a Simulink model with 2 subsystems:

+ **Subsystem_A** is a typical virtual subsystem; it contains some arithmetic operations inside.
+ **Atomic Subsystem_B** is an atomic subsystem; it also contains some arithmetic operations inside.

### Execution Order

First, let's see the execution order that MATLAB shows us. Subsystem_A has 2 actions with a non-continuous order, whereas Atomic Subsystem_B has 2 consecutive actions. That's why we say "Atomic subsystems are executed as a single indivisible unit".

### Algebraic Loops

Second, as you can see, there is a warning from MATLAB: "Block diagram 'Subsystem' contains 1 algebraic loop(s)". What is an "algebraic loop"?

> An algebraic loop means there is a signal that depends on itself in the same simulation step.

In other words, there is a signal that needs to be saved and used with its previous or past data. The reason is that there is data exchange between Atomic Subsystem_B and Subsystem_A:

+ **Atomic Subsystem_B** uses data from output f of Subsystem_A as its input.
+ **Subsystem_A** uses data from output e of Atomic Subsystem_B as its input.

This impacts the execution order. As you can see, MATLAB determines that Atomic Subsystem_B needs to run at order (1) because it provides input for order (2) in Subsystem_A. However, at the beginning, there is no data from output f yet, which doesn't make sense. Thus, output f of Subsystem_A and the input of Atomic Subsystem_B are actually interdependent in the same software cycle.




